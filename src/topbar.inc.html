dnl This is an include file. It is technically not a 'proper' html file, 
dnl although HTML is extremely forgiving and this would probably render fine by itself

dnl Also yes, these are m4 comments in an html file. Deal with it.
dnl vscode can still figure out what's going on, somehow, so i'm all good!

<div class="topbar">
    dnl TODO: This is where a logo would go
    <div class="logo bar-item">[LOGO]</div>
    <a href="HOSTSITE()/index.html" class="linkbutton bar-item">
        Home
    </a>
    <div class="theme-select bar-item">
        <input type="checkbox" class="theme-select-input">
        <label for="theme-select-input">Light theme</label>
    </div>
    <div class="topbar-fill bar-item"></div>
</div>

<script>
    function themeSwitchActivated(e) {
        if(e.currentTarget.checked === true) {
            // Add item to localstorage
            localStorage.setItem('theme', 'light');
            setTheme('light');
        } else {
            // Remove item if theme is switched back to normal
            localStorage.removeItem('theme');
            setTheme('dark');
        }
    }

    function setTheme(theme) {
        // Maybe this isn't the best way transfer JS variables into CSS, but I don't really care.
        // As long as it works, I'm going with it because I am an absolute noob at web dev.
        document.body.setAttribute("theme", theme);
    }

    const themeSwitches = document.getElementsByClassName('theme-select-input');
    for(let i = 0; i<themeSwitches.length; ++i) {
        const otherThemeSwitch = themeSwitches.item(i);
        otherThemeSwitch.checked = localStorage.getItem('theme') === 'light';
        otherThemeSwitch.addEventListener('change', themeSwitchActivated);
    }

    const themeSwitchChecked = themeSwitches.item(0).checked;
    if(themeSwitchChecked == true) {
        setTheme('light');
    } else {
        setTheme('dark');
    }

</script>